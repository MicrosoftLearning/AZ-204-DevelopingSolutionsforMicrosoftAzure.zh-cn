---
lab:
    az204Title: '实验室 12：通过使用 Azure 内容分发网络增强 Web 应用程序'
    az204Module: '模块 12：在解决方案中集成缓存和内容交付'
---

# 实验室 12：通过使用 Azure 内容分发网络增强 Web 应用程序

## Microsoft Azure 用户界面

鉴于 Microsoft 云工具的动态特性，Azure UI 在此培训内容开发后可能会发生更改。因此，实验室说明和实验室步骤可能无法完全一致。

当社区提醒我们进行必要的更改时，Microsoft 会更新本培训课程。然而，云更新的发生频率很高，因此你可能会遇到 UI 已更改但本培训内容尚未更新的情况。 **如果发生这种情况，请适应这些更改，并根据需要在实验室中熟悉这些更改。**

## 说明

### 准备工作

#### 登录实验室环境

使用以下凭据登录 Windows 10 虚拟机 (VM)：

- 用户名：**Admin**

- 密码： **Pa55w.rd**

> **备注**：你的讲师将提供连接到虚拟实验室环境的说明。

#### 查看已安装的应用程序

在你的 Windows 10 桌面上找到任务栏。任务栏包含了你在本实验室中会使用的应用程序图标：

- Microsoft Edge

## 体系结构图

![描绘通过使用 Azure 内容分发网络增强 Web 应用程序的体系结构图](./media/Lab12-Diagram.png)

### 练习 1：创建 Azure 资源

#### 任务 1：打开 Azure 门户

1. 在任务栏上，选择 **Microsoft Edge** 图标。

1. 在打开的浏览器窗口中，浏览到 Azure 门户 (<https://portal.azure.com>)，然后使用你将在本实验室中使用的帐户登录。

   > **备注**：第一次登录 Azure 门户时，你会看到一个门户教程。选择“**开始使用**”，跳过教程并开始使用门户。

#### 任务 2：创建存储帐户

1. 在 Azure 门户中，使用“**搜索资源、服务和文档**”文本框搜索“**存储帐户**”，然后在结果列表中选择“**存储帐户**”。

1. 在“**存储帐户**”边栏选项卡上，选择“**+ 创建**”。

1. 在“**创建存储帐户**”边栏选项卡上的“**基本信息**”选项卡上，执行以下操作，然后选择“**查看 + 创建**”。

   | 设置                           | 操作                                                       |
   | --------------------------------- | ------------------------------------------------------------ |
   | “**订阅**”下拉列表   | 保留默认值。                                    |
   | “**资源组**”部分        | 选择“**新建**”，输入 **MarketingContent**，然后选择“**确定**”。 |
   | “**存储帐户名称**”文本框 | 输入 **contenthost**_[yourname]_。                           |
   | “**区域**”下拉列表         | 选择“**(美国)美国东部**”。                                     |
   | “**性能**”部分           | 选择“**标准**”选项。                              |
   | “**冗余**”下拉列表     | 选择“**本地冗余存储(LRS)**”                  |

    以下屏幕截图显示了“**创建存储帐户**”边栏选项卡中的已配置设置。

    ![屏幕截图显示了“创建存储帐户”边栏选项卡上的已配置设置](./media/l12_create_a_storage_account.png)

1. 在“**查看 + 创建**”选项卡中，查看你在前面的步骤中选择的选项。

1. 选择“**创建**”，使用指定的配置创建存储帐户。

    > **备注**：等待创建任务完成，再继续本实验室。

#### 任务 3：使用 Azure 应用服务创建 Web 应用

1. 在 Azure 门户的导航窗格中，选择“**创建资源**”。

1. 在“**创建资源**”边栏选项卡上的“**搜索服务和市场**”文本框中，输入“**Web 应用**”，然后按 Enter。

1. 在“**搜索结果**”边栏选项卡中，选择“**Web 应用**”结果，然后选择“**创建**”。

1. 在“**创建 Web 应用**”边栏选项卡上的“**基本信息**”选项卡上，执行以下操作，然后选择“**下一步: Docker**”：

   | 设置                           | 操作                                                       |
   | --------------------------------- | ------------------------------------------------------------ |
   | “**订阅**”下拉列表   | 保留默认值。                                    |
   | “**资源组**”下拉列表 | 在列表中选择“**MarketingContent**”。                     |
   | “**名称**”文本框                 | 输入 **landingpage**_[yourname]_。                           |
   | “**发布**”部分               | 选择“**Docker 容器**”。                                 |
   | “**操作系统**”部分      | 选择“**Linux**”。                                            |
   | “**区域**”下拉列表         | 选择“**美国东部**”。                                          |
   | “**Linux 计划(美国东部)**”部分  | 选择“**新建**”。在“**名称**”文本框中，输入 **MarketingPlan**，然后选择“**确定**”。 |
   | “**SKU 和大小**”部分          | 保留默认值。                                    |

   以下屏幕截图显示了“**创建 Web 应用**”边栏选项卡上的已配置设置。

   ![屏幕截图显示了“创建 Web 应用”边栏选项卡上的已配置设置](./media/l12_create_web_app.png)

1. 在“**Docker**”选项卡上，执行以下操作，然后选择“**查看 + 创建**”：

   | 设置                         | 操作                                                    |
   | ------------------------------- | --------------------------------------------------------- |
   | “**选项**”下拉列表      | 选择“**单个容器**”。                              |
   | “**映像源**”下拉列表 | 选择“**Docker Hub**”。                                    |
   | “**访问类型**”下拉列表  | 选择“**公共**”。                                        |
   | “**映像和标记**”文本框      | 输入 **microsoftlearning/edx-html-landing-page:latest**。 |

   以下屏幕截图显示了“**Docker**”选项卡上的已配置设置。

   ![屏幕截图显示了“创建 Web 应用 - Docker”选项卡上的已配置设置](./media/l12_create_web_app_docker.png)

1. 在“**查看 + 创建**”选项卡中，查看你在前面的步骤中选择的选项。

1. 选择“**创建**”，使用指定的配置创建 Web 应用。

    > **备注**：等待创建任务完成，再继续本实验室。

1. 在 Azure 门户的导航窗格中，选择“**资源组**”。

1. 在“**资源组**”边栏选项卡上，选择你在本实验室前面部分创建的“**MarketingContent**”资源组。

1. 在“**MarketingContent**”边栏选项卡上，选择你在本实验室前面部分创建的 **landingpage**_[yourname]_ Web 应用。

1. 在“**应用服务**”边栏选项卡的“**设置**”部分，选择“**属性**”链接。

1. 在“**属性**”部分中，记录“**URL**”链接的值。你将在稍后的实验室中使用此值。

#### 回顾

在本练习中，你创建了一个 Azure 存储帐户和一个 Azure Web 应用，你稍后将在本实验使用。

### 练习 2：配置内容分发网络和终结点

#### 任务 1：打开 Azure Cloud Shell

1. 在 Azure 门户中，选择 **Cloud Shell** 图标 ![Cloud Shell 图标](./media/az204_lab_CloudShell.png)，打开新的 Bash 会话。如果 Cloud Shell 默认为 PowerShell 会话，请选择“**PowerShell**”，然后在下拉菜单中选择“**Bash**”。

    > **备注**：首次启动 **Cloud Shell** 时，系统会提示选择 **Bash** 或 **PowerShell**，请选择“**Bash**”。如果显示“**未挂载存储**”消息，请选择你在本实验室中使用的订阅，然后选择“**创建存储**”。

1. 在 Azure 门户中的 **Cloud Shell** 命令提示符处，运行以下命令以获取 Azure 命令行界面 (Azure CLI) 工具的版本：

    ```bash
    az --version
    ```

#### 任务 2：注册 Microsoft.CDN 提供程序

1. 在门户中的“**Cloud Shell**”命令提示符处，执行以下操作：

    a.  输入以下命令，然后按 Enter，以获取 Azure CLI 根级别的子组和命令列表：

    ```bash
    az --help
    ```

    b.  输入以下命令，然后按 Enter，以获取可用于资源提供程序的命令列表：

    ```bash
    az provider --help
    ```

    c.  输入以下命令，然后按 Enter，以列出当前已注册的所有提供程序：

     ```bash
     az provider list
     ```

    d.  输入以下命令，然后按 Enter，以仅列出当前已注册的提供程序的命名空间：

     ```bash
     az provider list --query "[].namespace"
     ```

    e.  观察当前已注册的提供程序列表。**Microsoft.CDN** 提供程序当前未包含在提供程序列表中。

    f.  输入以下命令，然后按 Enter，以获取注册新提供程序所需的标记：

     ```bash
     az provider register --help
     ```

    g.  输入以下命令，然后按 Enter，以使用当前订阅注册 **Microsoft.CDN** 命名空间：

     ```bash
     az provider register --namespace Microsoft.CDN
     ```

1. 关闭门户中的 **Cloud Shell** 窗格。

#### 任务 3：创建内容分发网络配置文件

1. 在 Azure 门户的导航窗格中，选择“**创建资源**”。

1. 在“**创建资源**”边栏选项卡上的“**搜索服务和市场**”文本框中，输入 **CDN**，然后按 Enter。

1. 在“**市场**”搜索结果边栏选项卡中，选择“**CDN**”结果，然后选择“**创建**”。

1. 在“**CDN 配置文件**”边栏选项卡上的“**基本信息**”选项卡上，执行以下操作，然后选择“**查看 + 创建**”：

   | 设置                                     | 操作                                   |
   | ------------------------------------------- | ---------------------------------------- |
   | “**订阅**”下拉列表             | 保留默认值。                |
   | “**资源组**”下拉列表           | 在列表中选择“**MarketingContent**”。 |
   | “**名称**”文本框                           | 输入 **contentdeliverynetwork**。        |
   | “**区域**”文本框                         | 保留默认值（全球）。       |
   | “**定价层**”下拉列表             | 选择“**标准 Akamai**”。              |
   | “**立即创建新的 CDN 终结点**”复选框 | 未选择。                            |

   以下屏幕截图显示了“**CDN 配置文件**”边栏选项卡上的已配置设置。

   ![屏幕截图显示了“创建 CDN 配置文件”边栏选项卡上的已配置设置。](./media/l12_create_CDN_profile.png)

1. 在“**查看 + 创建**”选项卡中，查看你在前面的步骤中选择的选项。

1. 选择“**创建**”以使用指定的配置创建 CDN 配置文件。
  
    > **备注**：等待 Azure 完成 CDN 配置文件创建后，再继续本实验室。你将会在应用创建完毕后收到通知。

#### 任务 4：配置储存容器

1. 在 Azure 门户的导航窗格中，选择“**资源组**”。

1. 在“**资源组**”边栏选项卡上，选择你在本实验室前面部分创建的“**MarketingContent**”资源组。

1. 在“**MarketingContent**”边栏选项卡上，选择你在本实验室前面部分创建的 **contenthost**_[yourname]_ 存储帐户。

1. 在“**存储帐户**”边栏选项卡中，选择“**数据存储**”部分的“**容器**”链接。

1. 在“**容器**”部分，选择“**+ 容器**”。

1. 在“**新建容器**”弹出窗口中，执行以下操作，然后选择“**创建**”：

   | 设置                                | 操作                                                  |
   | -------------------------------------- | ------------------------------------------------------- |
   | “**名称**”文本框                      | 输入“**媒体**”。                                        |
   | “**公共访问级别**”下拉列表 | 选择“**Blob (仅对 Blob 进行匿名读取访问)**”。 |

1. 在“**容器**”部分，再次选择“**+ 容器**”。

1. 在“**新建容器**”弹出窗口中，执行以下操作，然后选择“**创建**”：

   | 设置                                | 操作                                                  |
   | -------------------------------------- | ------------------------------------------------------- |
   | “**名称**”文本框                      | 输入“**视频**”。                                        |
   | “**公共访问级别**”下拉列表 | 选择“**Blob (仅对 Blob 进行匿名读取访问)**”。 |

1. 查看已更新的容器列表，并确认“**媒体**”和“**视频**”容器均已列出。

#### 任务 5：创建内容分发网络终结点

1. 在 Azure 门户的导航窗格中，选择“**资源组**”链接。

1. 在“**资源组**”边栏选项卡上，选择你在本实验室前面部分创建的“**MarketingContent**”资源组。

1. 在“**MarketingContent**”边栏选项卡上，选择你在本实验室前面部分创建的“**contentdeliverynetwork**” CDN 配置文件。

1. 在“**CDN 配置文件**”边栏选项卡中，选择“**+ 终结点**”。

1. 在“**添加终结点**”弹出对话框中，执行以下操作，然后选择“**添加**”：

   | 设置                                   | 操作                                                       |
   | ----------------------------------------- | ------------------------------------------------------------ |
   | “**名称**”文本框                         | 输入 **cdnmedia**_[yourname]_。                              |
   | “**源类型**”下拉列表            | 选择“**存储**”。                                          |
   | “**源主机名**”下拉列表        | 为你在本实验室前面部分创建的存储帐户选择“**contenthost*[yourname]*.blob.core.windows.net**”选项。 |
   | “**源路径**”文本框                  | 输入 **/media**。                                            |
   | “**源主机头**”文本框           | 保留默认值。                                    |
   | “**协议**”和“**源端口**”部分 | 保留默认值。                                   |
   | “**优化对象**”下拉列表          | 选择“**常规 Web 分发**”。                             |

   以下屏幕截图显示了“**添加终结点**”对话框中的已配置设置。

   ![屏幕截图显示了“添加终结点”对话框中的已配置设置。](./media/l12_add_an_endpoint.png)

1. 在“**CDN 配置文件**”边栏选项卡中，再次选择“**+ 终结点**”。

1. 在“**添加终结点**”弹出对话框中，执行以下操作，然后选择“**添加**”：

   | 设置                                   | 操作                                                       |
   | ----------------------------------------- | ------------------------------------------------------------ |
   | “**名称**”文本框                         | 输入 **cdnvideo**_[yourname]_。                              |
   | “**源类型**”下拉列表            | 选择“**存储**”。                                          |
   | “**源主机名**”下拉列表        | 为你在本实验室前面部分创建的存储帐户选择“**contenthost*[yourname]*.blob.core.windows.net**”选项。 |
   | “**源路径**”文本框                  | 输入 **/video**。                                            |
   | “**源主机头**”文本框           | 保留默认值。                                    |
   | “**协议**”和“**源端口**”部分 | 保留默认值。                                   |
   | “**优化对象**”下拉列表          | 选择“**点播视频媒体流式处理**”。                  |

   以下屏幕截图显示了“**添加终结点**”对话框中的已配置设置。

   ![屏幕截图显示了“添加终结点”对话框中的已配置设置。](./media/l12_add_an_endpoint2.png)

1. 在“**CDN 配置文件**”边栏选项卡中，再次选择“**+ 终结点**”。

1. 在“**添加终结点**”弹出对话框中，执行以下操作，然后选择“**添加**”：

   | 设置                                   | 操作                                                       |
   | ----------------------------------------- | ------------------------------------------------------------ |
   | “**名称**”文本框                         | 输入 **cdnweb**_[yourname]_。                                |
   | “**源类型**”下拉列表            | 选择“**Web 应用**”。                                          |
   | “**源主机名**”下拉列表        | 为你在本实验室前面部分创建的 Web 应用选择“**landingpage*[yourname]*.azurewebsites.net**”选项。 |
   | “**源路径**”文本框                  | 保留默认值。                                    |
   | “**源主机头**”文本框           | 保留默认值。                                    |
   | “**协议**”和“**源端口**”部分 | 保留默认值。                                   |
   | “**优化对象**”下拉列表          | 选择“**常规 Web 分发**”。                             |

   以下屏幕截图显示了“**添加终结点**”对话框中的已配置设置。

   ![屏幕截图显示了“添加终结点”对话框中的已配置设置。](./media/l12_add_an_endpoint3.png)

#### 回顾

在本练习中，你为内容分发网络 (CDN) 注册了资源提供程序，然后使用该提供程序创建了 CDN 配置文件和终结点资源。

### 练习 3：上传和配置静态 Web 内容

#### 任务 1：查看登录页面

1. 在 Azure 门户的导航窗格中，选择“**资源组**”。

1. 在“**资源组**”边栏选项卡上，选择你在本实验室前面部分创建的“**MarketingContent**”资源组。

1. 在“**MarketingContent**”边栏选项卡上，选择你在本实验室前面部分创建的 **landingpage**_[yourname]_ Web 应用。

1. 在“**应用服务**”边栏选项卡中，选择“**浏览**”。一个新的浏览器选项卡随即打开，并返回到当前网址。查看屏幕上显示的错误消息。必须配置指定的设置以引用多媒体内容，否则该网站将无法正常工作。

1. 返回显示 Azure 门户的当前打开的浏览器窗口。

#### 任务 2：上传存储 Blob

1. 在 Azure 门户的导航窗格中，选择“**资源组**”。

1. 在“**资源组**”边栏选项卡上，选择你在本实验室前面部分创建的“**MarketingContent**”资源组。

1. 在“**MarketingContent**”边栏选项卡上，选择你在本实验室前面部分创建的 **contenthost**_[yourname]_ 存储帐户。

1. 在“**存储帐户**”边栏选项卡中，选择“**数据存储**”部分的“**容器**”链接。

1. 在“**容器**”部分，选择“**媒体**”容器，然后选择“**上传**”。

1. 在“**上传 Blob**”弹出窗口中，执行以下操作：

    a.  在“**文件**”部分，选择“**文件夹**”图标。

    b.  在“**文件资源管理器**”窗口中，浏览到 **Allfiles (F):\\Allfiles\\Labs\\12\\Starter**，选择以下文件，然后选择“**打开**”：

    - **campus.jpg**

    - **conference.jpg**

    - **poster.jpg**

    c.  确保已选中“**如果文件已存在，请覆盖**”，然后选择“**上传**”。  

    > **备注**：等待 Blob 上传完成，然后再继续本实验室。

1. 在“**容器**”边栏选项卡中，选择“**设置**”部分下的“**属性**”。

1. 记录“**URL**”文本框中的值。你将在稍后的实验室中使用此值。

1. 关闭“**容器**”边栏选项卡。

1. 在“**容器**”边栏选项卡上，选择“**视频**”容器，然后选择“**上传**”。

1. 在“**上传 Blob**”弹出窗口中，执行以下操作：

    a.  在“**文件**”部分，选择“**文件夹**”图标。

    b.  在“**文件资源管理器**”窗口，浏览到 **Allfiles (F):\\Allfiles\\Labs\\12\\Starter**，选择“**welcome.mp4**”文件，然后选择“**打开**”：

    c.  确保已选中“**如果文件已存在，请覆盖**”，然后选择“**上传**”。  

    > **备注**：等待 Blob 上传完成，然后再继续本实验室。

1. 在“**容器**”边栏选项卡中，选择“**设置**”部分下的“**属性**”。

1. 记录“**URL**”文本框中的值。你将在稍后的实验室中使用此值。

#### 任务 3：配置 Web 应用设置

1. 在 Azure 门户的导航窗格中，选择“**资源组**”。

1. 在“**资源组**”边栏选项卡上，选择你在本实验室前面部分创建的“**MarketingContent**”资源组。

1. 在“**MarketingContent**”边栏选项卡上，选择你在本实验室前面部分创建的 **landingpage**_[yourname]_ Web 应用。

1. 在“**应用服务**”边栏选项卡的“**设置**”部分，选择“**配置**”链接。

1. 在“**配置**”部分，选择“**应用程序设置**”选项卡，然后选择“**新建应用程序设置**”。

1. 在“**添加/编辑应用程序设置**”弹出窗口中，配置以下设置，然后选择“**确定**”。

   | 设置                               | 操作                                                       |
   | ------------------------------------- | ------------------------------------------------------------ |
   | “**名称**”文本框                     | 输入 **CDNMediaEndpoint**。                                  |
   | “**值**”文本框                    | 输入你在本实验室前面部分记录的 **contenthost**_[yourname]_ 存储帐户中“**媒体**”容器的“**URI**”值。 |
   | “**部署槽位设置**”复选框 | 未选中。                                               |

1. 返回到“**配置**”部分，然后选择“**新建应用程序设置**”。

1. 在“**添加/编辑应用程序设置**”弹出窗口中，配置以下设置，然后选择“**确定**”。

   | 设置                               | 操作                                                       |
   | ------------------------------------- | ------------------------------------------------------------ |
   | “**名称**”文本框                     | 输入 **CDNVideoEndpoint**。                                  |
   | “**值**”文本框                    | 输入你在本实验室前面部分记录的 **contenthost**_[yourname]_ 存储帐户中“**视频**”容器的“**URI**”值。 |
   | “**部署槽位设置**”复选框 | 未选中。                                               |

1. 返回到“**配置**”部分，然后选择“**保存**”。选择“**继续**”以确认所做的更改。

   > **备注**：等待应用程序设置保存后再继续本实验室。

#### 任务 4：验证更正的登录页面

1. 在 Azure 门户的导航窗格中，选择“**资源组**”。

1. 在“**资源组**”边栏选项卡上，选择你在本实验室前面部分创建的“**MarketingContent**”资源组。

1. 在“**MarketingContent**”边栏选项卡上，选择你在本实验室前面部分创建的 **landingpage**_[yourname]_ Web 应用。

1. 在“**应用服务**”边栏选项卡上，选择“**重启**”，然后选择“**是**”以确认应用重启过程。

   > **备注**：等待重启操作完成后再继续本实验室。执行此操作时你会收到一条通知。

1. 在“**应用服务**”边栏选项卡中，选择“**浏览**”。一个新的浏览器窗口或选项卡随即打开，并返回到当前网址。查看更新后的网站，其呈现出各种类型的多媒体内容。

1. 返回显示 Azure 门户的当前打开的浏览器窗口。

#### 回顾

在本练习中，你已将多媒体内容作为 Blob 上传到存储容器，然后上传了你的 Web 应用，以直接指向存储 Blob。

### 练习 4：使用内容分发网络终结点

#### 任务 1：检索终结点统一资源标识符 (URIs)

1. 在 Azure 门户的导航窗格中，选择“**资源组**”链接。

1. 在“**资源组**”边栏选项卡上，选择你在本实验室前面部分创建的“**MarketingContent**”资源组。

1. 在“**MarketingContent**”边栏选项卡上，选择你在本实验室前面部分创建的“**contentdeliverynetwork**” CDN 配置文件。

1. 在“**CDN 配置文件**”边栏选项卡中，选择“**cdnmedia**_[yourname]_”终结点。

1. 在“**终结点**”边栏选项卡上，复制“**终结点主机名**”链接的值。你将在稍后的实验室中使用此值。

1. 关闭“**终结点**”边栏选项卡。

1. 在“**CDN 配置文件**”边栏选项卡中，选择“**cdnvideo**_[yourname]_”终结点。

1. 在“**终结点**”边栏选项卡上，复制“**终结点主机名**”链接的值。你将在稍后的实验室中使用此值。

1. 关闭“**终结点**”边栏选项卡。

#### 任务 2：测试多媒体内容

1. 通过将你此前在本实验室中复制的 **cdnmedia**_[yourname]_ 终结点中的“**终结点主机名**” URL 与 **/campus.jpg** 的相对路径合并，为 **campus.jpg** 资源构造 URL。

    > **备注**：例如，如果你的**终结点主机名** URL 为 `https://cdnmediastudent.azureedge.net/`，新构造的 URL 将为 `https://cdnmediastudent.azureedge.net/campus.jpg`。

1. 通过将你此前在本实验室中复制的 **cdnmedia**_[yourname]_ 终结点中的“**终结点主机名**” URL 与 **/conference.jpg** 的相对路径合并，为 **conference.jpg** 资源构造 URL。

    > **备注**：例如，如果你的**终结点主机名** URL 为 `https://cdnmediastudent.azureedge.net/`，新构造的 URL 将为 `https://cdnmediastudent.azureedge.net/conference.jpg`。

1. 通过将你此前在本实验室中复制的 **cdnmedia**_[yourname]_ 终结点中的“**终结点主机名**” URL 与 **/poster.jpg** 的相对路径合并，为 **poster.jpg** 资源构造 URL。

    > **备注**：例如，如果你的**终结点主机名** URL 为 `https://cdnmediastudent.azureedge.net/`，新构造的 URL 将为 `https://cdnmediastudent.azureedge.net/poster.jpg`。

1. 通过将你此前在本实验室中复制的 **cdnvideo**_[yourname]_ 终结点中的“**终结点主机名**” URL 与 **/welcome.mp4** 的相对路径合并，为 **welcome.mp4** 资源构造 URL。

    > **备注**：例如，如果你的**终结点主机名** URL 为 `https://cdnvideostudent.azureedge.net/`，新构造的 URL 将为 `https://cdnvideostudent.azureedge.net/welcome.mp4`。


1. 在任务栏中，激活“**Microsoft Edge**”图标的快捷菜单，然后选择“**新建窗口**”。

1. 在新的浏览器窗口中，转到你为 **campus.jpg** 媒体资源构造的 URL，然证是否成功找到了该资源。

    > **备注**：如果内容尚不可用，则表示 CDN 终结点仍在初始化。初始化过程可能需要 5 到 15 分钟。

1. 转到你为 **conference.jpg** 媒体资源构造的 URL，验证是否成功找到了该资源。

1. 转到你为 **poster.jpg** 媒体资源构造的 URL，验证是否成功找到了该资源。

1. 转到你为 **welcome.mp4** 视频资源构造的 URL，验证是否成功找到了该资源。

1. 关闭在此任务中创建的浏览器窗口。

#### 任务 3：更新 Web 应用设置

1. 在 Azure 门户的导航窗格中，选择“**资源组**”。

1. 在“**资源组**”边栏选项卡上，选择你在本实验室前面部分创建的“**MarketingContent**”资源组。

1. 在“**MarketingContent**”边栏选项卡上，选择你在本实验室前面部分创建的 **landingpage**_[yourname]_ Web 应用。

1. 在“**应用服务**”边栏选项卡的“**设置**”部分，选择“**配置**”链接。

1. 在“**配置**”部分，选择“**应用程序设置**”选项卡。

1. 选择现有的“**CDNMediaEndpoint**”应用程序设置。

1. 在“**添加/编辑应用程序设置**”弹出对话框中，输入你在本实验室前面部分复制的 **cdnmedia**_[yourname]_ 终结点的“**终结点主机名**” URL，然后选择“**确定**”，以更新“**值**”文本框。

1. 选择现有的“**CDNVideoEndpoint**”应用程序设置。

1. 在“**添加/编辑应用程序设置**”弹出对话框中，输入你在本实验室前面部分复制的 **cdnvideo**_[yourname]_ 终结点的“**终结点主机名**” URL，然后选择“**确定**”，以更新“**值**”文本框。

1. 选择“**保存**”，然后选择“**继续**”以确认更改。  

   > **备注**：等待应用程序设置保存后再继续本实验室。

1. 在“**配置**”部分，选择“**概述**”。

1. 在“**概述**”部分，选择“**重启**”，然后选择“**是**”以确认应用重启过程。

   > **备注**：等待重启操作完成后再继续本实验室。操作完成时，你会收到一条通知。

#### 任务 4：测试网页内容

1. 在 Azure 门户的导航窗格中，选择“**资源组**”链接。

1. 在“**资源组**”边栏选项卡上，选择你在本实验室前面部分创建的“**MarketingContent**”资源组。

1. 在“**MarketingContent**”边栏选项卡上，选择你在本实验室前面部分创建的“**contentdeliverynetwork**” CDN 配置文件。

1. 在“**CDN 配置文件**”边栏选项卡中，选择“**cdnweb**_[yourname]_”终结点。

1. 在“**终结点**”边栏选项卡上，复制“**终结点主机名**”链接的值。


1. 在任务栏中，激活“**Microsoft Edge**”图标的快捷菜单，然后选择“**新建窗口**”。


1. 在新的浏览器窗口，转到 **cdnweb**_[yourname]_ 终结点的“**终结点主机名**” URL。

1. 查看所有使用内容分发网络提供的网站和多媒体内容。

#### 回顾

在本练习中，你更新了你的 web 应用，使用内容分发网络来为多媒体内容和 Web 应用程序本身提供服务。

### 练习 5：清理订阅

#### 任务 1：打开 Azure Cloud Shell

1. 在 Azure 门户中，选择 **Cloud Shell** 图标 ![Cloud Shell 图标](./media/az204_lab_CloudShell.png)，打开新的 Bash 会话。如果 Cloud Shell 默认为 PowerShell 会话，请选择“**PowerShell**”，然后在下拉菜单中选择“**Bash**”

    > **备注**：首次启动 **Cloud Shell** 时，系统会提示选择 **Bash** 或 **PowerShell**，请选择“**PowerShell**”。如果显示“**未挂载存储**”消息，请选择你在本实验室中使用的订阅，然后选择“**创建存储**”。

#### 任务 2：删除资源组

1. 在 **Cloud Shell** 窗格中运行以下命令，以删除“**MarketingContent**”资源组：

    ```bash
    az group delete --name MarketingContent --no-wait --yes
    ```

     > **备注**：该命令以异步方式运行（由 *--no-wait* 参数确定），因此，尽管可立即在同一 Bash 会话中运行另一个 Azure CLI 命令，但实际上要花几分钟才能删除资源组。

1. 关闭门户中的 **Cloud Shell** 窗格。

#### 任务 3：关闭活动的应用程序

1. 关闭当前正在运行的 Microsoft Edge 应用程序。

#### 回顾

在本练习中，你通过删除本实验室中曾经使用的资源组来清理订阅。
